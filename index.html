<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>devcs</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="devcs"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="devcs"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="devcs"><meta property="og:url" content="http://example.com/"><meta property="og:site_name" content="devcs"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:author" content="kcs"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com"},"headline":"devcs","image":["http://example.com/img/og_image.png"],"author":{"@type":"Person","name":"kcs"},"publisher":{"@type":"Organization","name":"devcs","logo":{"@type":"ImageObject"}},"description":""}</script><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/rainbow.css"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400&amp;family=Roboto" rel="stylesheet"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link id="dark" rel="stylesheet" href="/css/custom.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">devcs</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item is-active" href="/">🌙</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/devcs96"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-9-tablet is-9-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-02-06T09:45:58.000Z" title="2022. 2. 6. 오후 6:45:58">2022-02-06</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-02-06T15:21:20.519Z" title="2022. 2. 7. 오전 12:21:20">2022-02-07</time></span><span class="level-item"><a class="link-muted" href="/categories/Computer-Science/">Computer Science</a><span> / </span><a class="link-muted" href="/categories/Computer-Science/Network/">Network</a><span> / </span><a class="link-muted" href="/categories/Computer-Science/Network/IT-%EC%97%94%EC%A7%80%EB%8B%88%EC%96%B4%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%9E%85%EB%AC%B8/">IT 엔지니어를 위한 네트워크 입문</a></span><span class="level-item">12 minutes read (About 1848 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/02/06/2022-02-06-network-ch03/">네트워크 통신하기</a></h1><div class="content"><h2 id="네트워크-통신-방식"><a href="#네트워크-통신-방식" class="headerlink" title="네트워크 통신 방식"></a>네트워크 통신 방식</h2><h2 id="Unicast"><a href="#Unicast" class="headerlink" title="Unicast"></a>Unicast</h2><ul>
<li> 출발지와 목적지가 1:1 통신</li>
</ul>
<h2 id="BroadCast"><a href="#BroadCast" class="headerlink" title="BroadCast"></a>BroadCast</h2><ul>
<li>같은 네트워크에 존재하는 모든 host가 목적지 (1: 모든 통신)</li>
<li>local 네트워크 내에서 모든 host에게 패킷을 전달할 때 사용됨</li>
<li>IPv6에서는 브로드 캐스트가 존재하지 않고, 링크 로컬 멀티캐스트로 대체되어 사용되고 있다. </li>
</ul>
<h2 id="Multicast"><a href="#Multicast" class="headerlink" title="Multicast"></a>Multicast</h2><ul>
<li>다수의 특정 목적지로 데이터 전송 (1: 멀티캐스트 구독 호스트들)</li>
</ul>
<h2 id="AnyCast"><a href="#AnyCast" class="headerlink" title="AnyCast"></a>AnyCast</h2><ul>
<li>가장 가까운 호스트 (1:1 통신인데, 목적지는 동일 그룹내 1개 호스트 )</li>
<li>가장 가까운 DNS 서버 , Gateway를 찾는데 사용하기도 함 </li>
<li>Unicast와 다르게 anycast는 같은 목적지 주소를 가진 서버가 여러대이다. </li>
</ul>
<h2 id="BUM-트래픽"><a href="#BUM-트래픽" class="headerlink" title="BUM 트래픽"></a>BUM 트래픽</h2><ul>
<li>B(broadcast) , U(Unknown unicast) , M(multicast) 을 지칭 , BUM 트래픽이 많으면 네트워크 성능 저하 </li>
<li>unknown unicast는 스위치가 목적지 주소를 몰라 , 모든 포트로 전송하는데 이러한 unicast를 unknown unicast라고 함 (unicast지만, 마치 broadcast와 유사한 동작 )</li>
<li>이더넷 환경에서는 ARP broadcast를 먼저 보내고 통신을 시작하므로 BUM 트래픽이 많이 발생하지 않음 </li>
</ul></div><a class="article-more button is-small is-size-7" href="/2022/02/06/2022-02-06-network-ch03/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-02-05T03:21:00.000Z" title="2022. 2. 5. 오후 12:21:00">2022-02-05</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-02-05T11:04:48.375Z" title="2022. 2. 5. 오후 8:04:48">2022-02-05</time></span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a><span> / </span><a class="link-muted" href="/categories/Java/Effective-Java-3-E/">Effective Java 3/E</a></span><span class="level-item">3 minutes read (About 484 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/02/05/2022-02-05-Item54/">Item54. null이 아닌 빈 collection 이나 배열을 반환하라</a></h1><div class="content"><p>다음은 주변에서 흔히 볼 수 있는 method이다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> List&lt;Cheese&gt; cheeseInStock = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Cheese&gt; <span class="title">getCheese</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> cheeseInStock.isEmpty() ? <span class="keyword">null</span> : <span class="keyword">new</span> ArrayList&lt;&gt;(cheeseInStock);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>null을 반환해야할 특별한 이유가 있는 게 아니라면 위와 같이 빈 collection 대신에 null을 반환하는 코드는 이를 사용하는 client가 아래와 같이 null처리 로직을 작성하게끔 만든다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Cheese&gt; cheese = shop.getCheese();</span><br><span class="line"><span class="keyword">if</span>(cheese != <span class="keyword">null</span>)&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>collection이나 배열같은 container가 비었을 떄 null을 반환하는 method를 사용할 때면 항상 이와 같은 방어 코드를 넣어주어야 한다. </p>
<p>null을 반환하는 족에서는 빈 container 를 만드는데도 비용이 드니 null을 반환하는게 낫다는 주장도 있지만 이는 잘못된 주장이다. 빈 container를 만드는데는 성능 차이가 미미하며, 굳이 빈 collection 과 배열은 새로 할당하지 않고도 반환할 수 있다. </p></div><a class="article-more button is-small is-size-7" href="/2022/02/05/2022-02-05-Item54/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-02-03T10:02:45.000Z" title="2022. 2. 3. 오후 7:02:45">2022-02-03</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-02-04T13:34:05.406Z" title="2022. 2. 4. 오후 10:34:05">2022-02-04</time></span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a><span> / </span><a class="link-muted" href="/categories/Java/Effective-Java-3-E/">Effective Java 3/E</a></span><span class="level-item">4 minutes read (About 545 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/02/03/2022-02-03-Item53/">Item53. 가변인수는 신중히 사용하라</a></h1><div class="content"><h2 id="가변인수"><a href="#가변인수" class="headerlink" title="가변인수"></a>가변인수</h2><p>가변인수 method는 명시한 타입의 인수를 0개 이상 받을 수 있다.<br>가변인수 method를 호출하면 가장 먼저 인수의 개수와 길이가 같은 배열을 만들고, 인수들을 이 배열에 저장하여 가변인수 method에 건네준다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span>... args)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> arg : args) &#123;</span><br><span class="line">            sum += arg;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>가변인수 개수가 1개 이상이여야만 할떄가 있다. 예를 들면 최솟값을 찾는 method에서 인수0개가 들어오면 exception이 터져야 한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span>... args)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(args.length == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;인수가 1개 이상 필요합니다.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> min = args[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i&lt; args.length ; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (args[i] &lt; min) &#123;</span><br><span class="line">            min = args[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> min;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>위 방식의 문제점은 가변인수의 인수를 넣지 않아도 호출되어 runtime에 실패한다는 점이다. 또한 가변인수에 대한 유효성 검사도 명시적으로 해야 한다. </p>
<p>이를 더 나은 방법으로 runtime이 아닌 compile time에 에러가 나오도록 수정하면 다음과 같다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> firstArg , <span class="keyword">int</span>... remainingArgs)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> min = firstArg;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> arg : remainingArgs) &#123;</span><br><span class="line">            <span class="keyword">if</span>(arg&lt;min)&#123;</span><br><span class="line">                min = arg;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> min;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


<p>매개변수를 2개 받아서, 첫번째 매개변수는 필수여야하는 인수를 넣고, 두번째는 가변인수로 받아서 인수가 1개 미만일떄는 compile error가 터진다 </p></div><a class="article-more button is-small is-size-7" href="/2022/02/03/2022-02-03-Item53/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-02-01T15:29:37.000Z" title="2022. 2. 2. 오전 12:29:37">2022-02-02</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-02-06T09:44:25.910Z" title="2022. 2. 6. 오후 6:44:25">2022-02-06</time></span><span class="level-item"><a class="link-muted" href="/categories/Computer-Science/">Computer Science</a><span> / </span><a class="link-muted" href="/categories/Computer-Science/Network/">Network</a><span> / </span><a class="link-muted" href="/categories/Computer-Science/Network/IT-%EC%97%94%EC%A7%80%EB%8B%88%EC%96%B4%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%9E%85%EB%AC%B8/">IT 엔지니어를 위한 네트워크 입문</a></span><span class="level-item">18 minutes read (About 2687 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/02/02/2022-02-02-network-ch02/">네트워크 연결과 구성요소</a></h1><div class="content"><h2 id="네트워크-연결-구분"><a href="#네트워크-연결-구분" class="headerlink" title="네트워크 연결 구분"></a>네트워크 연결 구분</h2><p>네트워크는 규모에 따라 LAN,MAN,WAN 3가지로 구분된다. </p>
<p>1.LAN(Local Area Network) : 사용자 내부 네트워크 (근거리 통신망으로 주로 집 , 사무실 단위)<br>2.MAN(Metro Area Network) : 한 도시 정도를 연결하고 관리하는 네트워크<br>3.WAN(Wide Area Network) : 멀리 떨어진 LAN을 연결해주는 네트워크 </p>
<p><img src="/images/network-ch02-01.jpg"></p>
<h2 id="네트워크-회선"><a href="#네트워크-회선" class="headerlink" title="네트워크 회선"></a>네트워크 회선</h2><h2 id="인터넷-회선"><a href="#인터넷-회선" class="headerlink" title="인터넷 회선"></a>인터넷 회선</h2><ul>
<li>인터넷 접속을 위해 통신사업자와 연결하는 회선 </li>
</ul>
<p>인터넷 가입자와 통신사업자간에는 직접 연결되는 구조가 아니라 전송 선로 공유 기술을 사용한다. 예를 들어 아파트 광랜은 아파트에서 통신사업자까지 연결한 회선을 아파트 가입자가 공유하는 구조임. 즉, 전송 선로를 공유하므로 전용 회선과 다르게 속도가 보장되지 않는다 (주변 사용량에 따라 속도가 느려질 수도 있다. )</p>
<p>인터넷 회선 종류는 다음과 같다.</p>
<ul>
<li>광랜(이더넷) , FTFH , 동축 케이블 인터넷 , xDSL</li>
</ul>
<h2 id="전용-회선"><a href="#전용-회선" class="headerlink" title="전용 회선"></a>전용 회선</h2><ul>
<li>가입자와 통신사업자 간에 대역폭(bandwith,링크 용량)을 보장해주는 서비스.</li>
</ul>
<p>가입자와 통신사업자 간에는 전용 케이블로 연결되어 있고, 통신사업자 내부에서 TDM(Time Division Mulitiplexing) 같은 기술로 마치 직접 연결한 것처럼 통신 품질을 보장해준다. </p>
<h2 id="인터넷-전용-회선"><a href="#인터넷-전용-회선" class="headerlink" title="인터넷 전용 회선"></a>인터넷 전용 회선</h2><ul>
<li>인터넷 회선에 대한 통신 대역폭을 보장해주는 서비스 </li>
</ul>
<p>가입자가 통신사업자와 연결되고 이 연결이 다시 인터넷과 연결되는 구조이다. </p>
<h2 id="VPN-Virtual-private-network-가설-사설망"><a href="#VPN-Virtual-private-network-가설-사설망" class="headerlink" title="VPN (Virtual private network , 가설 사설망 )"></a>VPN (Virtual private network , 가설 사설망 )</h2><ul>
<li>물리적으로는 전용선이 아니지만, 가상으로 직접 연결한 것 같은 효과가 나도록 만들어주는 네트워크 기술 </li>
</ul>
<p>ex) 재택근무중인데 회사 사설망에 연결되어있는 것처럼 업무 가능 </p>
<ul>
<li>통신사업자 VPN  : VPN 서비스를 ISP에서 제공하며 전용선의 거리에 비례하는 비용문제가 있다. </li>
<li>가입자 VPN : 일반 인터넷망을 이용해 가상 네트워크를 구성할 수 있다. </li>
</ul>
<h2 id="네트워크-구성-요소"><a href="#네트워크-구성-요소" class="headerlink" title="네트워크 구성 요소"></a>네트워크 구성 요소</h2><h2 id="네트워크-인터페이스-카드-NIC"><a href="#네트워크-인터페이스-카드-NIC" class="headerlink" title="네트워크 인터페이스 카드 (NIC)"></a>네트워크 인터페이스 카드 (NIC)</h2><p>흔히 랜카드,네트워크 카드, 네트워크 인터페이스 컨트롤러로도 불리는 네트워크 인터페이스 카드는 컴퓨터를 네트워크에 연결하기 위한 하드웨어 장치이다. </p>
<p>노트북과 데스크탑 PC에서는 기본적으로 온보드 형태로 장착됨으로 별도로 추가할 필요는 없으나, 서버의 경우에 여러 네트워크에 동시에 연결하거나 혹은 더 높은 대역폭이 필요한 경우, 네트워크 인터페이스 카드를 추가로 장착한다. </p>
<p>네트워크 인터페이스 카드의 주요 역할은 다음과 같다. </p>
<ul>
<li><p>직렬화 (Serialization) : 전기적 신호를 bit열의 데이터 신호 형태로 , bit열의 데이터 신호 형태를 전기적 신호 형태로 변환시켜주는데, 이러한 상호 변환작업을 직렬화라고 한다. </p>
</li>
<li><p>MAC 주소  : 네트워크 인터페이스 카드는 고유한 MAC주소를 가지고 있어서, 받은 패킷의 도착지 MAC주소가 자신의 MAC주소가 아니면 폐기하고 맞으면 전달한다. </p>
</li>
<li><p>흐름 제어 (Flow control) : 이미 통신 중인 데이터 처리 떄문에 새로운 데이터를 받지 못하는 상황에서 데이터 유실 방지를 위해 상대방에서 통신 중지를 요청할 수 있다. </p>
</li>
</ul></div><a class="article-more button is-small is-size-7" href="/2022/02/02/2022-02-02-network-ch02/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-01-31T07:11:22.000Z" title="2022. 1. 31. 오후 4:11:22">2022-01-31</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-02-05T03:17:59.800Z" title="2022. 2. 5. 오후 12:17:59">2022-02-05</time></span><span class="level-item"><a class="link-muted" href="/categories/Computer-Science/">Computer Science</a><span> / </span><a class="link-muted" href="/categories/Computer-Science/Network/">Network</a><span> / </span><a class="link-muted" href="/categories/Computer-Science/Network/IT-%EC%97%94%EC%A7%80%EB%8B%88%EC%96%B4%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%9E%85%EB%AC%B8/">IT 엔지니어를 위한 네트워크 입문</a></span><span class="level-item">17 minutes read (About 2508 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/31/2022-01-31-network-ch01/">OSI 7 계층과 TCP/IP</a></h1><div class="content"><h2 id="Protocol"><a href="#Protocol" class="headerlink" title="Protocol"></a>Protocol</h2><ul>
<li>네트워크에서는 통신할떄의 규약을 protocol이라고 함. </li>
<li>최근 이더넷 - TCP/IP 기반 protocol로 획일화되고 있는 추세이다. <ul>
<li>물리적인 측면 : 데이터 전송 매체 , 신호 규약 , 회선 규격 등 이더넷이 널리 쓰인다. </li>
<li>논리적인 측면 : 장치들간에 통신하기 위한 protocol 규격으로 TCP/IP가 널리 쓰인다. </li>
</ul>
</li>
</ul>
<p>과거에는 네트워크 환경과 컴퓨팅 환경이 열악해 한정된 자원으로 최대한 효율적인 protocol을 정의하고 사용해야 했음.  따라서 대부분의 protocol이 문자 기반이 아닌 2진수 bit 기반으로 만들어졌음. application level의 protocol은 bit 기반이 아닌 문자기반으로 많이 사용되고 있음. ex) HTTP,SMTP</p>
<p>문자기반으로 사용할 경우, 효율성은 bit 기반 protocol보다 많이 떨어지지만 다양한 확장이 가능하다. </p>
<h2 id="TCP-IP-protocol-stack"><a href="#TCP-IP-protocol-stack" class="headerlink" title="TCP/IP protocol stack"></a>TCP/IP protocol stack</h2><ul>
<li><p>TCP(transport 계층)와 IP(network 계층)는 별도의 계층에서 동작하는 protocol 이지만 함께 사용하고 있는데 , 이런 프로토콜의 묶음을 protocol stack이라고 부름 </p>
</li>
<li><p>TCP/IP protocol stack은 총 4개 부분으로 나뉜다. </p>
</li>
</ul>
<p><img src="/images/network-ch01-01.jpg"></p>
<h2 id="OSI-7계층과-TCP-IP"><a href="#OSI-7계층과-TCP-IP" class="headerlink" title="OSI 7계층과 TCP/IP"></a>OSI 7계층과 TCP/IP</h2><ul>
<li>OSI 7계층은 네트워크의 주요 reference model로 활용되고 있지만, 현재는 대부분의 protocol이 TCP/IP protocol stack 기반으로 되어 있다. </li>
</ul>
<p><img src="/images/network-ch01-02.jpg"></p>
<ul>
<li>계층별로 표준화된 protocol을 개발함으로서 네트워크 구성 요소들을 모듈화 할 수 있다. </li>
<li>모듈화함으로서 기존에 다른 계층의 protocol들과 연동해 사용할 수 있다. </li>
</ul>
<p>OSI 7계층은 다시 2가지 계층으로 나뉜다. </p>
<ol>
<li>Data Flow layer (Lower Layer) : 1~4 계층 </li>
<li>Application Layer (Upper Layer) : 5~7 계층 </li>
</ol>
<p>Data flow layer 는 데이터를 상대방에게 잘 전달하는 역할을 가지고 있으며 , application layer는 데이터를 잘 표현하는데 역할을 가지고 있다. 따라서 네트워크 엔지니어는 Data flow layer 을 고려하고, application 개발자는 application layer를 고려한다. </p>
<p><img src="/images/network-ch01-03.jpg"></p>
<h2 id="OSI-7계층과-TCP-IP-protocol-stack의-차이점"><a href="#OSI-7계층과-TCP-IP-protocol-stack의-차이점" class="headerlink" title="OSI 7계층과 TCP/IP protocol stack의 차이점"></a>OSI 7계층과 TCP/IP protocol stack의 차이점</h2><ul>
<li>OSI reference model은 7 계층으로 이루어진 반면, TCP/IP 모델은 4계층으로 구분된다. </li>
</ul>
<p><img src="/images/network-ch01-04.jpg"></p>
<ul>
<li>TCPI/IP 모델은 상위 3개 계층 (application,presentation,session) 은 하나의 application 계층으로 묶고, 하위 2개 계층 (physical , data link) 계층을 하나의 network access 계층으로 분류한다. </li>
</ul></div><a class="article-more button is-small is-size-7" href="/2022/01/31/2022-01-31-network-ch01/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-01-31T02:34:20.000Z" title="2022. 1. 31. 오전 11:34:20">2022-01-31</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-01-31T04:17:09.915Z" title="2022. 1. 31. 오후 1:17:09">2022-01-31</time></span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a><span> / </span><a class="link-muted" href="/categories/Java/Effective-Java-3-E/">Effective Java 3/E</a></span><span class="level-item">10 minutes read (About 1571 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/31/2022-01-31-Item52/">Item52. 다중정의는 신중히 사용하라</a></h1><div class="content"><h2 id="매개변수가-동일한-부모-타입일떄-overloading의-문제점"><a href="#매개변수가-동일한-부모-타입일떄-overloading의-문제점" class="headerlink" title="매개변수가 동일한 부모 타입일떄 overloading의 문제점"></a>매개변수가 동일한 부모 타입일떄 overloading의 문제점</h2><p>다음과 같이 collection을 집합, 리스트 , 그외로 구분하고자 만든 CollectionClassifier 프로그램이 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionClassifier</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">classify</span><span class="params">(Set&lt;?&gt; s)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;set&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">classify</span><span class="params">(List&lt;?&gt; lst)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;list&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">classify</span><span class="params">(Collection&lt;?&gt; c)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;others&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Collection&lt;?&gt;[] collections = &#123;</span><br><span class="line">                <span class="keyword">new</span> HashSet&lt;String&gt;(),</span><br><span class="line">                <span class="keyword">new</span> ArrayList&lt;BigInteger&gt;(),</span><br><span class="line">                <span class="keyword">new</span> HashMap&lt;String,String&gt;().values()</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Collection&lt;?&gt; c : collections) &#123;</span><br><span class="line">            System.out.println(classify(c));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>collection에 set,list,map을 넣어주면 예상결과는 set,list,others인데 실제로는 others만 세번 출력된다.<br>그 이유는 다중정의(overloading)된 classify증에 어느 method를 실행할지가 compile time에 정해지기 떄문이다. compile time에 for문안의 c는 항상 Collection&lt;?&gt; 타입이다. runtime에는 타입이 매번 달라지지만 호출할 method를 선택하는데는 영향을 주지 못한다. </p>
<h2 id="overloading-vs-overriding"><a href="#overloading-vs-overriding" class="headerlink" title="overloading vs overriding"></a>overloading vs overriding</h2><p>재정의한 method는 동적으로 runtime에 선택되고, 다중정의한 method는 정적으로 compile time에 선택된다. method를 재정의했다면 해당 객체의 runtime 타입이 어떤 method를 호출할지의 기준이 된다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Wine</span></span>&#123;</span><br><span class="line">    <span class="function">String <span class="title">name</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> <span class="string">&quot;Wine&quot;</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SparklingWine</span> <span class="keyword">extends</span> <span class="title">Wine</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">String <span class="title">name</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> <span class="string">&quot;SparklingWine&quot;</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Champagne</span> <span class="keyword">extends</span> <span class="title">SparklingWine</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">String <span class="title">name</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> <span class="string">&quot;Champagne&quot;</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Overriding</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        List&lt;Wine&gt; wineList = List.of(<span class="keyword">new</span> Wine(), <span class="keyword">new</span> SparklingWine(), <span class="keyword">new</span> Champagne());</span><br><span class="line">        <span class="keyword">for</span> (Wine wine : wineList) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;wine.name() = &quot;</span> + wine.name());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//출력 결과 </span><br><span class="line">wine.name() = Wine</span><br><span class="line">wine.name() = SparklingWine</span><br><span class="line">wine.name() = Champagne</span><br></pre></td></tr></table></figure>
<p>위와 같이 runtime에 객체 타입을 보고 재정의한 method가 호출된다. <strong> 반면에 다중정의한 method사이에서는 객체의 runtime 타입은 전혀 중요치 않다. 선택은 compile time에 오직 매개변수의 compile time 타입에 의해 이뤄진다. </strong></p>
<p>CollectionClassifier program이 runtime에 객체 타입에 따라 반환결과를 다르게 하고 싶다면 아래와 같이 classify method를 모두 하나로 합친 뒤, instanceof 로 명시적으로 runtime에 수정해야 한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">classify</span><span class="params">(Collection&lt;?&gt; c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> c <span class="keyword">instanceof</span> Set ? <span class="string">&quot;set&quot;</span> : c <span class="keyword">instanceof</span> List ? <span class="string">&quot;list&quot;</span> : <span class="string">&quot;others&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<ul>
<li>overloading시 compile time에 호출 method가 매개변수 타입을 보고 결정되므로, overriding 과는 동작방식이 다르다. 따라서 client가 사용했을때, 혼동을 일으키는 상황을 되도록 주지 않는 것이 좋다.</li>
</ul></div><a class="article-more button is-small is-size-7" href="/2022/01/31/2022-01-31-Item52/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-01-30T15:35:19.000Z" title="2022. 1. 31. 오전 12:35:19">2022-01-31</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-01-30T15:38:23.739Z" title="2022. 1. 31. 오전 12:38:23">2022-01-31</time></span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a><span> / </span><a class="link-muted" href="/categories/Java/Effective-Java-3-E/">Effective Java 3/E</a></span><span class="level-item">6 minutes read (About 859 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/31/2022-01-31-Item47/">Item 47. 반환 타입으로는 stream보다는 collection이 낫다.</a></h1><div class="content"><p>stream은 반복을 지원하지 않으므로, API를 stream만 반환하도록 짜놓으면 반환된 stream을 for-each로 반복하길 원하는 사용자는 사용이 힘들다</p>
<p>stream은 Iterable 인터페이스가 정의한 추상 method를 모두 포함할뿐 아니라, Iterable 인터페이스가 명시한 스펙대로 동작하지만 Iterable을 확장하고 있지는 않기 때문에 for-each문으로 반복이 불가능하다. </p>
<p>따라서 stream의 iterator method에 method 참조를 건네고, 이를 매개변수화된 Iterable로 적절히 형변환하면 동작은 한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(ProcessHandle ph: (Iterable&lt;ProcessHandler&gt;) ProcessHandle.allProcesses()::iterator)&#123;</span><br><span class="line">    <span class="comment">// process 처리 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="adapter-method"><a href="#adapter-method" class="headerlink" title="adapter method"></a>adapter method</h2><p>하지만 이렇게 stream을 사용하기는 가독성이 떨어지므로, adapter method를 사용하는 방안이 있다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Stream&lt;E&gt; 를 Iterable&lt;E&gt;로 중개해주는 adapter </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;E&gt; <span class="function">Iterable&lt;E&gt; <span class="title">iterableOf</span><span class="params">(Stream&lt;E&gt; stream)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> stream::iterator;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>adapter method를 사용하면 어떤 stream도 for-each문으로 반복할 수 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(ProcessHandle p : iterableOf(ProcessHandle.allProcesses()))&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>반대의 상황으로서 API가 iterable만 반환하면 이를 stream 으로 사용하고자 하는 사용자는 사용이 힘들다. 따라서 adapter method를 제공하는 방안이 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Iterable&lt;E&gt;를 Stream&lt;E&gt;로 중개해주는 adapter </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;E&gt; <span class="function">Stream&lt;E&gt; <span class="title">streamOf</span><span class="params">(Iterable&lt;E&gt; iterable)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> StreamSupport.stream(iterable.spliterator(),<span class="keyword">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><a class="article-more button is-small is-size-7" href="/2022/01/31/2022-01-31-Item47/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-01-27T13:52:08.000Z" title="2022. 1. 27. 오후 10:52:08">2022-01-27</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-02-05T03:12:53.920Z" title="2022. 2. 5. 오후 12:12:53">2022-02-05</time></span><span class="level-item"><a class="link-muted" href="/categories/Computer-Science/">Computer Science</a><span> / </span><a class="link-muted" href="/categories/Computer-Science/OS/">OS</a></span><span class="level-item">11 minutes read (About 1600 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/27/2022-01-27-os-scheduling/">Scheduling</a></h1><div class="content"><h2 id="FIFO-First-in-First-out"><a href="#FIFO-First-in-First-out" class="headerlink" title="FIFO (First in, First out)"></a>FIFO (First in, First out)</h2><p>FIFO(First-in-First-out,선입선출) 또는 FCFS(First-Come-First-Served,FCFS) 스케쥴링이다. </p>
<p>말그대로 먼저 도착한 process부터 cpu를 할당받는 것이다. </p>
<p>FIFO방식의 가장 큰 문제점은 작업 실행 시간이 긴 process가 먼저 왔을때, 뒤에 있는 process들이 이를 끝나기를 기다려야 한다는 점이다. 이를 convoy effect라고 부른다. </p>
<p><img src="/images/os-scheduling-01.jpg"></p>
<h2 id="SJF-Shortest-Job-First"><a href="#SJF-Shortest-Job-First" class="headerlink" title="SJF(Shortest Job First)"></a>SJF(Shortest Job First)</h2><p>가장 짧은 실행 시간을 가진 작업을 먼저 실행시킨다. </p>
<p><img src="/images/os-scheduling-02.jpg"></p>
<p>FIFO에서 가지는 convoy-effect문제를 해결할 수 있으나, 모든 작업이 동시에 도착한다는 가정하에서다. 즉 긴 작업이 짧은 작업보다 먼저 도착한다면 여전히 convoy-effect문제가 발생할 수도 있다. </p>
<p><img src="/images/os-scheduling-03.jpg"></p>
<p>예를 들면 위처럼 작업시간이 긴 A라는 process가 먼저 도착했고, 그 뒤에 작업 시간이 짧은 B,C가 도착하였다. SJF는 비선점형이므로, A가 끝날떄까지 기다려야 한다. </p>
<p>위의 FIFO와 SJF는 비선점형 scheduler로 각 작업이 종료될떄까지 계속 수행된다. 이제부터 정리할 스케쥴링 알고리즘은 선점형 방식으로 작업이 종료되기 전에 다른 작업으로 전환이 가능하다 </p></div><a class="article-more button is-small is-size-7" href="/2022/01/27/2022-01-27-os-scheduling/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-01-27T12:32:50.000Z" title="2022. 1. 27. 오후 9:32:50">2022-01-27</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-01-27T13:46:21.864Z" title="2022. 1. 27. 오후 10:46:21">2022-01-27</time></span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a><span> / </span><a class="link-muted" href="/categories/Java/Effective-Java-3-E/">Effective Java 3/E</a></span><span class="level-item">5 minutes read (About 745 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/27/2022-01-27-Item51/">Item51. method 시그니처를 신중히 설계하라</a></h1><div class="content"><p>이번 아이템에서는 API 설계 권고 사항들을 정리하였다. </p>
<h2 id="method-이름을-신중히-짓자"><a href="#method-이름을-신중히-짓자" class="headerlink" title="method 이름을 신중히 짓자."></a>method 이름을 신중히 짓자.</h2><ul>
<li>항상 표준 명명 규칙 (Item68)을 따라야 한다. </li>
<li>같은 패키지에 속한 다른 이름들과 일관되게 짓는게 최우선이다. </li>
<li>개발자 커뮤니티에서 널리 받아 들여지는 이름을 사용하자</li>
<li>긴 이름은 피하자 </li>
</ul>
<h2 id="편의-method를-너무-많이-만들지-말자"><a href="#편의-method를-너무-많이-만들지-말자" class="headerlink" title="편의 method를 너무 많이 만들지 말자"></a>편의 method를 너무 많이 만들지 말자</h2><ul>
<li>method가 너무 많은 class는 익히고 , 사용하고, 문서화하고 , 테스트하고 유지보수하기 어렵다. 따라서 아주 자주 쓰일때만 편의 method로 만들자 </li>
</ul>
<h2 id="매개변수-목록은-짧게-유지하자"><a href="#매개변수-목록은-짧게-유지하자" class="headerlink" title="매개변수 목록은 짧게 유지하자"></a>매개변수 목록은 짧게 유지하자</h2><ul>
<li>매개변수가 4개를 넘어가면 가독성이 떨어진다. </li>
<li>같은 type의 매개변수가 여러개 연달아 나오는 경우에는 특히 순서가 변경되어도 그대로 실행됨으로 좋지 않다. </li>
</ul></div><a class="article-more button is-small is-size-7" href="/2022/01/27/2022-01-27-Item51/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-01-27T10:19:00.000Z" title="2022. 1. 27. 오후 7:19:00">2022-01-27</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-01-27T11:47:55.029Z" title="2022. 1. 27. 오후 8:47:55">2022-01-27</time></span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a><span> / </span><a class="link-muted" href="/categories/Java/Effective-Java-3-E/">Effective Java 3/E</a></span><span class="level-item">6 minutes read (About 951 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/27/2022-01-27-Item50/">Item50. 적시에 방어적 복사본을 만들라</a></h1><div class="content"><p>클래스 불변식을 클라이언트가 꺠트릴 수 없도록 방어적으로 프로그래밍해야 한다.</p>
<p>다음과 같이 클래스 불변식을 유지하고자 하는 class가 있다고 가정하자</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Period</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Date start;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Date end;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> start 시작 시간</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end 종료 시각 , 시작 시간보다 뒤여야 한다.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalArgumentException : 시작 시간이 종료시각보다 늦을떄 발생한다.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NullPointerException : start나 end가 null이면 발생한다.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Period</span><span class="params">(Date start, Date end)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(start.compareTo(end) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(start + <span class="string">&quot; after &quot;</span> + end);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.start = start;</span><br><span class="line">        <span class="keyword">this</span>.end = end;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">start</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> start;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">end</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> end;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Period class는 한번 값이 설정되면 변경되지 않는 것 처럼 보이나 Date class 자체가 가변이라는 사실을 이용하면 클래스 불변식을 꺠트릴 수 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Date start = <span class="keyword">new</span> Date();</span><br><span class="line">    Date end = <span class="keyword">new</span> Date();</span><br><span class="line">    Period p = <span class="keyword">new</span> Period(start, end);</span><br><span class="line">    end.setYear(<span class="number">68</span>); <span class="comment">// p 객체의 값이 변경된다. </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>따라서 Period class를 불변으로 유지하려면 불변 필드인 Instant를 사용해야 한다. </p>
<h2 id="방어적-복사-defensive-copy"><a href="#방어적-복사-defensive-copy" class="headerlink" title="방어적 복사 (defensive copy)"></a>방어적 복사 (defensive copy)</h2><p>외부 공격으로부터 class 불변식을 유지하려면 생성자에서 받은 가변 매개변수는 모두 방어적으로 복사해야 한다. </p>
<p>예시로든 Period class에 방어적 복사를 적용하면 다음과 같이 생성자에서 복사본을 필드로 가지게 만들고, 접근자에서도 복사본을 반환함으로서 클래스 불변식을 유지할 수 있다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Period</span><span class="params">(Date start, Date end)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.start = <span class="keyword">new</span> Date(start.getTime());</span><br><span class="line">    <span class="keyword">this</span>.end = <span class="keyword">new</span> Date(end.getTime());</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.start.compareTo(<span class="keyword">this</span>.end) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(start + <span class="string">&quot; after &quot;</span> + end);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Date <span class="title">start</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Date(start.getTime());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Date <span class="title">end</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Date(end.getTime());</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><a class="article-more button is-small is-size-7" href="/2022/01/27/2022-01-27-Item50/#more">Read more</a></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/page/0/">Previous</a></div><div class="pagination-next"><a href="/page/2/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/11/">11</a></li></ul></nav></div><div class="column column-left is-2-tablet is-2-desktop is-2-widescreen  order-1"><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Computer-Science/"><span class="level-start"><span class="level-item">Computer Science</span></span><span class="level-end"><span class="level-item tag">17</span></span></a><ul><li><a class="level is-mobile" href="/categories/Computer-Science/Algorithm/"><span class="level-start"><span class="level-item">Algorithm</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Computer-Science/Data-Structure/"><span class="level-start"><span class="level-item">Data Structure</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Computer-Science/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Computer-Science/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/Computer-Science/Network/IT-%EC%97%94%EC%A7%80%EB%8B%88%EC%96%B4%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%9E%85%EB%AC%B8/"><span class="level-start"><span class="level-item">IT 엔지니어를 위한 네트워크 입문</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Computer-Science/OS/"><span class="level-start"><span class="level-item">OS</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Design-Pattern/"><span class="level-start"><span class="level-item">Design Pattern</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Infrastructure/"><span class="level-start"><span class="level-item">Infrastructure</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/Infrastructure/Kubernetes/"><span class="level-start"><span class="level-item">Kubernetes</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">59</span></span></a><ul><li><a class="level is-mobile" href="/categories/Java/Effective-Java-3-E/"><span class="level-start"><span class="level-item">Effective Java 3/E</span></span><span class="level-end"><span class="level-item tag">53</span></span></a></li><li><a class="level is-mobile" href="/categories/Java/Jpa/"><span class="level-start"><span class="level-item">Jpa</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Java/Junit/"><span class="level-start"><span class="level-item">Junit</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Java/Jvm/"><span class="level-start"><span class="level-item">Jvm</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Javascript/"><span class="level-start"><span class="level-item">Javascript</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Nodejs/"><span class="level-start"><span class="level-item">Nodejs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/Nodejs/express/"><span class="level-start"><span class="level-item">express</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/kotlin/"><span class="level-start"><span class="level-item">kotlin</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/spring/"><span class="level-start"><span class="level-item">spring</span></span><span class="level-end"><span class="level-item tag">18</span></span></a><ul><li><a class="level is-mobile" href="/categories/spring/Batch/"><span class="level-start"><span class="level-item">Batch</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/spring/Core-Concept/"><span class="level-start"><span class="level-item">Core Concept</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/spring/Design-Pattern/"><span class="level-start"><span class="level-item">Design Pattern</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/spring/Jpa/"><span class="level-start"><span class="level-item">Jpa</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/spring/%ED%86%A0%EB%B9%84%EC%9D%98-spring/"><span class="level-start"><span class="level-item">토비의 spring</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%EA%B0%9C%EB%B0%9C-%EC%83%81%EC%8B%9D/"><span class="level-start"><span class="level-item">개발 상식</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/%EA%B0%9C%EB%B0%9C-%EC%83%81%EC%8B%9D/Git/"><span class="level-start"><span class="level-item">Git</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-02-06T09:45:58.000Z">2022-02-06</time></p><p class="title"><a href="/2022/02/06/2022-02-06-network-ch03/">네트워크 통신하기</a></p><p class="categories"><a href="/categories/Computer-Science/">Computer Science</a> / <a href="/categories/Computer-Science/Network/">Network</a> / <a href="/categories/Computer-Science/Network/IT-%EC%97%94%EC%A7%80%EB%8B%88%EC%96%B4%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%9E%85%EB%AC%B8/">IT 엔지니어를 위한 네트워크 입문</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-02-05T03:21:00.000Z">2022-02-05</time></p><p class="title"><a href="/2022/02/05/2022-02-05-Item54/">Item54. null이 아닌 빈 collection 이나 배열을 반환하라</a></p><p class="categories"><a href="/categories/Java/">Java</a> / <a href="/categories/Java/Effective-Java-3-E/">Effective Java 3/E</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-02-03T10:02:45.000Z">2022-02-03</time></p><p class="title"><a href="/2022/02/03/2022-02-03-Item53/">Item53. 가변인수는 신중히 사용하라</a></p><p class="categories"><a href="/categories/Java/">Java</a> / <a href="/categories/Java/Effective-Java-3-E/">Effective Java 3/E</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-02-01T15:29:37.000Z">2022-02-02</time></p><p class="title"><a href="/2022/02/02/2022-02-02-network-ch02/">네트워크 연결과 구성요소</a></p><p class="categories"><a href="/categories/Computer-Science/">Computer Science</a> / <a href="/categories/Computer-Science/Network/">Network</a> / <a href="/categories/Computer-Science/Network/IT-%EC%97%94%EC%A7%80%EB%8B%88%EC%96%B4%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%9E%85%EB%AC%B8/">IT 엔지니어를 위한 네트워크 입문</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-31T07:11:22.000Z">2022-01-31</time></p><p class="title"><a href="/2022/01/31/2022-01-31-network-ch01/">OSI 7 계층과 TCP/IP</a></p><p class="categories"><a href="/categories/Computer-Science/">Computer Science</a> / <a href="/categories/Computer-Science/Network/">Network</a> / <a href="/categories/Computer-Science/Network/IT-%EC%97%94%EC%A7%80%EB%8B%88%EC%96%B4%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%9E%85%EB%AC%B8/">IT 엔지니어를 위한 네트워크 입문</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">February 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">42</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">November 2021</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li></ul></div></div></div><!--!--></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>
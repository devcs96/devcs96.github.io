<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Dao의 점진적인 Refactorying을 통해 알아보는 객체지향설계원칙 - devcs</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="devcs"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="devcs"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="간단정리chapter1에서는 Spring FrameWork의 관심사인 Object 설계와 구현 및 동작원리에 초점을 두고 있다. Dao 설계를 이상적인 설계인 ‘변경이 용이한 구조’를 만들기 위해 순차적으로 코드를 Refactorying 하여서 가장 이상적인 설계를 설명하고 이와 밀접히 관련되어 있는 스프링의 주요 개념인 IoC(Inversion of Co"><meta property="og:type" content="blog"><meta property="og:title" content="Dao의 점진적인 Refactorying을 통해 알아보는 객체지향설계원칙"><meta property="og:url" content="http://example.com/2021/07/20/2021-07-20-spring-01/"><meta property="og:site_name" content="devcs"><meta property="og:description" content="간단정리chapter1에서는 Spring FrameWork의 관심사인 Object 설계와 구현 및 동작원리에 초점을 두고 있다. Dao 설계를 이상적인 설계인 ‘변경이 용이한 구조’를 만들기 위해 순차적으로 코드를 Refactorying 하여서 가장 이상적인 설계를 설명하고 이와 밀접히 관련되어 있는 스프링의 주요 개념인 IoC(Inversion of Co"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://example.com/images/not-SDP.jpg"><meta property="og:image" content="http://example.com/images/SDP.jpg"><meta property="og:image" content="http://example.com/images/dao-final2.jpg"><meta property="article:published_time" content="2021-07-20T12:51:06.000Z"><meta property="article:modified_time" content="2021-07-27T14:57:54.000Z"><meta property="article:author" content="kcs"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/images/not-SDP.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2021/07/20/2021-07-20-spring-01/"},"headline":"Dao의 점진적인 Refactorying을 통해 알아보는 객체지향설계원칙","image":["http://example.com/images/not-SDP.jpg","http://example.com/images/SDP.jpg","http://example.com/images/dao-final2.jpg"],"datePublished":"2021-07-20T12:51:06.000Z","dateModified":"2021-07-27T14:57:54.000Z","author":{"@type":"Person","name":"kcs"},"publisher":{"@type":"Organization","name":"devcs","logo":{"@type":"ImageObject"}},"description":"간단정리chapter1에서는 Spring FrameWork의 관심사인 Object 설계와 구현 및 동작원리에 초점을 두고 있다. Dao 설계를 이상적인 설계인 ‘변경이 용이한 구조’를 만들기 위해 순차적으로 코드를 Refactorying 하여서 가장 이상적인 설계를 설명하고 이와 밀접히 관련되어 있는 스프링의 주요 개념인 IoC(Inversion of Co"}</script><link rel="canonical" href="http://example.com/2021/07/20/2021-07-20-spring-01/"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/rainbow.css"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400&amp;family=Roboto" rel="stylesheet"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link id="dark" rel="stylesheet" href="/css/custom.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">devcs</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/">🌙</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/devcs96"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-9-tablet is-9-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-07-20T12:51:06.000Z" title="2021. 7. 20. 오후 9:51:06">2021-07-20</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-07-27T14:57:54.000Z" title="2021. 7. 27. 오후 11:57:54">2021-07-27</time></span><span class="level-item"><a class="link-muted" href="/categories/spring/">spring</a><span> / </span><a class="link-muted" href="/categories/spring/%ED%86%A0%EB%B9%84%EC%9D%98-spring/">토비의 spring</a></span><span class="level-item">17 minutes read (About 2594 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Dao의 점진적인 Refactorying을 통해 알아보는 객체지향설계원칙</h1><div class="content"><h2 id="간단정리"><a href="#간단정리" class="headerlink" title="간단정리"></a>간단정리</h2><p>chapter1에서는 Spring FrameWork의 관심사인 Object 설계와 구현 및 동작원리에 초점을 두고 있다. Dao 설계를 이상적인 설계인 <strong>‘변경이 용이한 구조’</strong>를 만들기 위해 순차적으로 코드를 Refactorying 하여서 가장 이상적인 설계를 설명하고 이와 밀접히 관련되어 있는 스프링의 주요 개념인<strong> IoC(Inversion of Control)</strong> 개념을 소개한다. </p>
<span id="more"></span>
<hr>

<ul>
<li>순수 JDBC를 통한 Database Connection </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao_V1</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(User user)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException </span>&#123;</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        Connection c = DriverManager.getConnection(</span><br><span class="line">                <span class="string">&quot;jdbc:mysql://localhost:3306/spring_study?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf8 &quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;1234&quot;</span>);</span><br><span class="line">        PreparedStatement ps = c.prepareStatement(</span><br><span class="line">                <span class="string">&quot;insert into users(id,name,password) values(?,?,?)&quot;</span></span><br><span class="line">        );</span><br><span class="line">        ps.setString(<span class="number">1</span>,user.getId());</span><br><span class="line">        ps.setString(<span class="number">2</span>,user.getName());</span><br><span class="line">        ps.setString(<span class="number">3</span>,user.getPassword());</span><br><span class="line"></span><br><span class="line">        ps.executeUpdate();</span><br><span class="line"></span><br><span class="line">        ps.close();</span><br><span class="line">        c.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">get</span><span class="params">(String id)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException </span>&#123;</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        Connection c = DriverManager.getConnection(</span><br><span class="line">                <span class="string">&quot;jdbc:mysql://localhost:3306/spring_study?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf8 &quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;1234&quot;</span>);</span><br><span class="line"></span><br><span class="line">        PreparedStatement ps = c.prepareStatement(</span><br><span class="line">                <span class="string">&quot;select * from users where id = ?&quot;</span></span><br><span class="line">        );</span><br><span class="line">        ps.setString(<span class="number">1</span>,id);</span><br><span class="line">        ResultSet rs = ps.executeQuery();</span><br><span class="line">        rs.next();</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line"></span><br><span class="line">        user.setId(rs.getString(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">        user.setName(rs.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">        user.setPassword(rs.getString(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">        rs.close();</span><br><span class="line">        ps.close();</span><br><span class="line">        c.close();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>순수 JDBC를 통한 Connection 의 문제는 다음과 같이 정리할 수 있다.</p>
<ol>
<li>과도한 중복코드 </li>
<li>너무 많은 관심사가 하나의 method안에 있다.<br>ex) DB Connection을 어떡할것인지, 리소스 처리를 어떡할것인지<br>관심사의 분리는 별도의 class로 모듈화 함으로 분리될 수 있다.<br>책에서는 순차적으로 중복된 code를 제거하기 위해 method extraction 을 소개하고 있다. </li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UserDao_V2</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException </span>&#123;</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> DriverManager.getConnection(</span><br><span class="line">                <span class="string">&quot;jdbc:mysql://localhost:3306/spring_study?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf8 &quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;1234&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>method 추출을 통해 중복된 코드를 하나의 method로 분리하였다.<br>중복된 코드를 줄임으로서 얻는 장점은 변경의 원인도 중복이 아닌 한곳이라는 것이다. 즉 변경이 생겼을떄 한곳만 변경하면 된다.</p>
<p>여기서 나아가 변화에 용이한 구조를 만들기 위해 상속구조를 소개하였다. DB Connection 정보를 추상화하여, Client들 별로 사용하고 싶은 DB Connection을 구현한다.</p>
<p>ex) UserDao의 DB connection을 A,B,C,D사에게 넘겨주고, 구현은 알아서 하고, UserDao는  DB Connection의 구체구현을 몰라도 그냥 DB Connection이 반환되었구나 라고 알면된다는 소리다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span></span>&#123;</span><br><span class="line">    <span class="comment">//  추상 클래스를 만들어 add,get 은 구현하고 connection은 하위 클래스에게 구현의 책임을 맡긴다. </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException,SQLException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(User user)</span> <span class="keyword">throws</span> ClassNotFoundException,SQLException</span>&#123;</span><br><span class="line">        <span class="comment">// default method 구현 </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">(String id)</span> <span class="keyword">throws</span> ClassNotFoundException,SQLException</span>&#123;</span><br><span class="line">        <span class="comment">// default method 구현 </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>위 코드의 주요 장점은 <strong>확장성</strong>이다. 새로운 DB Connection을 구현하고 싶다면 그냥 상속받아서 구현하면 된다.</p>
<p>위와 같이 부모class에서 기본적인 logic흐름이 있고, 그 일부를 추상 method나 overrding가능한 protected method로 만들고 자식class에서 구현해서 사용하는 방법을 Template Method Pattern이라고 한다. 자세한 내용은 Design Pattern 카테고리에 별도로 첨부하였다 </p>
<p>하지만 DB연결방식을 하위class로 그 외Data Access 로직을 상위 class로 잡은 상속 구조에도 단점이 있다. </p>
<ol>
<li>변화의 이유 , 시기, 주기가 다르다.<br>ex) 데이터를 어떻게 전처리 할 것인지 로직이 변경되어도 DB Connection을 얻는 로직은 변경되지 않는다.</li>
</ol>
<p>이러한 문제를 책에서는 상속구조가 아닌 별도의 class로 관심사를 분리하는 형태로 접근하였다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao_V3</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> SimpleConnectionMaker simpleConnectionMaker = <span class="keyword">new</span> SimpleConnectionMaker();</span><br><span class="line"><span class="comment">// 1. Data를 어떻게 추가할 것인가에 대한 관심 </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(User user)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException </span>&#123;</span><br><span class="line">        Connection c = simpleConnectionMaker.makeNewConnection();</span><br><span class="line">    <span class="comment">// ~</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2. DB 연결에 대한 관심 </span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleConnectionMaker</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Connection <span class="title">makeNewConnection</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException</span>&#123;</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        Connection c = DriverManager.getConnection(</span><br><span class="line">                <span class="string">&quot;jdbc:mysql://localhost:3306/spring_study?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf8 &quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;1234&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line">````</span><br><span class="line">관심사를 별도의 <span class="class"><span class="keyword">class</span>로 분리하였지만, 상속구조에서 가졌던 기능 확장이 다시 불가능해졌다. 예를 들면 <span class="title">DB</span> 연결 <span class="title">method</span>명이 변경되면 일일히 <span class="title">Dao</span> 에서 변경해야 한다. 또한 <span class="title">UserDao</span> <span class="title">Class</span>가 어떤 <span class="title">DB</span> <span class="title">connection</span>을 받는지 알아야 한다. </span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">```<span class="title">java</span></span></span><br><span class="line"><span class="class"><span class="title">MariaDBConnectionMaker</span>.<span class="title">makeNewConnection</span>()</span>;</span><br><span class="line">MysqlDBConnectionMaker.makeNewConnection();</span><br><span class="line">OracleDBConnectionMaker.makeNewConnection();</span><br></pre></td></tr></table></figure>
<p>정리를 하면 UserDao가 DB connection을 가지고 오는 class에 대해 너무 많이 알면, 종속적으로 되기 때문에 DB connection이 변경되면 같이 변경된다. 이를 소프트웨어공학에서는 SDP(stable dependency principle) 을 따르지 않는다고 하는데, 변경될 가능성이 큰 구체 class를 의존하는 것을 말한다. </p>
<p><img src="/images/not-SDP.jpg"></p>
<p>책에서는 class를 분리하면서도 UserDao가 DB Connection에 대해 종속적이지 않는 구조를 만들기 위해 다음과 같이 추상화 계층을 만들었다.</p>
<p><img src="/images/SDP.jpg"></p>
<p>위 구조는 구체 class인 B의 공통적인 틀을 정의하는 추상클래스를 도출하고, 하위 구현방법은 B의 구체 class에서 구현하였다.<br>그리고 B와 의존성 관계에 있는 A class는 B의 추상클래스에 의존함으로써, B의 구체 class의 서비스 로직이 변경된다고 하더라도 영향받지 않는다.</p>
<p>책에서도 마찬가지로 DB연결정보를 인터페이스를 통해 공통적인 성격을 추상화하고,UserDao는 추상화한 인터페이스에 접근하여 실제로 DB연결정보가 어떻게 구현되어있는지는 종속적이지 않도록 구조를 변경하였다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UserDao_V4</span></span><br><span class="line"><span class="comment">// 추상화를 통해 인터페이스를 만듦</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ConnectionMaker</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Connection <span class="title">makeNewConnection</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DconnectionMaker</span> <span class="keyword">implements</span> <span class="title">ConnectionMaker</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Connection <span class="title">makeNewConnection</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException </span>&#123;</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        Connection c = DriverManager.getConnection(</span><br><span class="line">                <span class="string">&quot;jdbc:mysql://localhost:3306/spring_study?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf8 &quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;1234&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao_V4</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  UserDao는 구체 class가 아닌 안정된 인터페이스에 종속적으로 변경</span></span><br><span class="line">    <span class="keyword">private</span> ConnectionMaker connectionMaker;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserDao</span><span class="params">(ConnectionMaker connectionMaker)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.connectionMaker = <span class="keyword">new</span> DconnectionMaker();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(User user)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException </span>&#123;</span><br><span class="line">        Connection c = connectionMaker.makeNewConnection();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>위와 같이 구조 변경을 통해서 이제 확장성까지 갖추게 되었다. 다른 DB연결정보로 확장하고 싶으면 UserDao에서 new Dconnection() 대신 new xConnection(); 으로 변경해주면 된다. 하지만 바로 이부분이 문제이다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao_V4</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ConnectionMaker connectionMaker;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserDao</span><span class="params">(ConnectionMaker connectionMaker)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// UserDao에서 구체적인 하위 class를 명시해야 한다.</span></span><br><span class="line">        <span class="keyword">this</span>.connectionMaker = <span class="keyword">new</span> DconnectionMaker();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>UserDao에서 대부분의 종속성은 제거하였지만, 생성자에서 외부 객체를 주입받는 과정에서 어떤 객체를 사용할지 구체클래스를 명시를 하고 있다. 즉 어떤 연결정보를 사용할지에 따라 DconnectionMaker인지, 다른 connectionMaker인지 UserDao에서 명시해야 한다는 단점이 있다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ConnectionMaker connectionMaker = <span class="keyword">new</span> DconnectionMaker();</span><br></pre></td></tr></table></figure>
<p>위 관계는 class사이의 관계가 만들어진것이 아니라 객체사이에 관계가 맺어진것으로 class사이의 관계와는 구분해야 한다. </p>
<p>class사이의 관계는 클래스 명이 type으로 드러나야하는 반면 object사이의 관계는 다형성 특징을 통해 해당 class를 알지 못하더라도, 해당 class가 구현한 interface를 사용했다면 그 class의 object를 부모 type으로 받아서 사용할 수 있다.</p>
<p>어쨌거나, 어느 DB 커넥션을 사용할지는 UserDao <strong>Client</strong>의 관심으로 object 사이의 관계를 설정해주어야 한다. </p>
<p>현재 UserDao를 main method 에서 사용하므로, 사용하는 client는 main이라고 할 수 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao_V5</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ConnectionMaker connectionMaker;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserDao</span><span class="params">(ConnectionMaker connectionMaker)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.connectionMaker =connectionMaker;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ~~~</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// UserDao Client가 어느 DB연결을 쓸지 결정하여 UserDao에게 DI해준다. </span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        ConnectionMaker connectionMaker =  <span class="keyword">new</span> DconnectionMaker();</span><br><span class="line">        <span class="comment">// Client가 오브젝트 사이의 의존관계를 설정해준다. </span></span><br><span class="line">        UserDao userDao = <span class="keyword">new</span> UserDao(connectionMaker);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>이제 관심사를 분리하였으며, 확장도 가능한 구조로 변경을 완료하였다.<br>만약에 DB연결정보를 변경한다면 다음과 같이 UserDao에 손대지 않고 변경이<br>가능하다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//Dconnection말고 NConnection으로 변경해주세요 </span></span><br><span class="line">        <span class="comment">//Dconnection -&gt; Nconnection </span></span><br><span class="line">        ConnectionMaker connectionMaker =  <span class="keyword">new</span> NconnectionMaker();</span><br><span class="line">        UserDao userDao = <span class="keyword">new</span> UserDao(connectionMaker);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/images/dao-final2.jpg"></p>
<p>정리하면 위와 같은 최종구조를 갖는다. 위 구조는 디자인 패턴에서 전략 패턴(startegy pattern)에 속한다. 자세한 전략패턴에 대한 설명은 별도로 정리해두었다. (<a target="_blank" rel="noopener" href="http://localhost:5000/2021/07/20/2021-07-20-spring-ch1-dao-01/#more">전략패턴</a>)</p>
<p>위 구조는 객체 지향 설계 원칙 중에 하나인 OCP (SOLID의 O, Open closed Principle) 을 구현했다고 할 수 있는데, <strong></p>
<hr>
OCP(Open Closed Principle,개방폐쇄원칙)는 모듈이 변경에는 닫혀있고, 확장에는 열려 있어야 한다.</strong> 
<hr>

<p>여기서 점진적으로 발전시킨 UserDao class는 변경에는 닫혀있다. “코드에 어떠한 수정없이 DB연결정보를 확장시킬수 있다” 라는 측면에서 OCP를 준수하였다라고 말할 수 있다. 책에서는 OCP를 준수했다는 것을 <strong>높은 응집도(coherence)와 낮은 결합도(coupling)를 갖는다</strong>고도 표현한다.</p>
<p>간략하게 정리하면 다음과 같다. </p>
<hr>
- 응집도(Coherence) : 모듈 내부의 요소들이 관련되어 있는 정도, 높은 응집도를 갖는다는 것은 모듈의 내부 요소들이 하나의 책임과 관련이 있고, 변경의 원인이 하나라는 의미. 즉 관심사가 하나다. 
<hr>
- 결합도(Coupling): 모듈간의 서로 상호 의존하는 정도 , 낮은 결합도를 갖는 다는 것은 다른 모듈에게 변화를 요구하지 않고, 변경이 전파되지 않는다는 것을 의미. 
<hr>


<p>위와 같이 Dao를 v1~v5까지 refactorying 하면서 ocp를 준수하도록 설계하였다.<br>그렇다면 이와 관련되어있는 spring의 IoC개념은 무엇일까?<br>간단하게 설명하면 program의 제어 흐름이 뒤바뀐 것이다. 자세한 내용은 다음 포스팅에서 살펴보도록 하겠다. </p>
</div><!--!--></article></div><!--!--><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "a52dbd7f5ac1a8961fb30d11d71c889b",
            repo: "gittalk",
            owner: "devcs96",
            clientID: "ad3debd03c0e5f289948",
            clientSecret: "471b03d4771d8a3467d95e33fde1e2d8804d5da8",
            admin: ["devcs96"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            
        })
        gitalk.render('comment-container')</script></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/07/21/2021-07-21-item5/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Item5. 자원을 직접 명시하지 말고, DI를 통해 객체를 주입받자</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/07/20/2021-07-20-item4/"><span class="level-item">Item4. 인스턴스화를 막을려면 private생성자를 이용하라</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></div><div class="column column-left is-2-tablet is-2-desktop is-2-widescreen  order-1"><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Computer-Science/"><span class="level-start"><span class="level-item">Computer Science</span></span><span class="level-end"><span class="level-item tag">20</span></span></a><ul><li><a class="level is-mobile" href="/categories/Computer-Science/Algorithm/"><span class="level-start"><span class="level-item">Algorithm</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Computer-Science/Data-Structure/"><span class="level-start"><span class="level-item">Data Structure</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Computer-Science/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Computer-Science/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul><li><a class="level is-mobile" href="/categories/Computer-Science/Network/IT-%EC%97%94%EC%A7%80%EB%8B%88%EC%96%B4%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%9E%85%EB%AC%B8/"><span class="level-start"><span class="level-item">IT 엔지니어를 위한 네트워크 입문</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Computer-Science/OS/"><span class="level-start"><span class="level-item">OS</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Design-Pattern/"><span class="level-start"><span class="level-item">Design Pattern</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Infrastructure/"><span class="level-start"><span class="level-item">Infrastructure</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/Infrastructure/Kubernetes/"><span class="level-start"><span class="level-item">Kubernetes</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">66</span></span></a><ul><li><a class="level is-mobile" href="/categories/Java/Effective-Java-3-E/"><span class="level-start"><span class="level-item">Effective Java 3/E</span></span><span class="level-end"><span class="level-item tag">60</span></span></a></li><li><a class="level is-mobile" href="/categories/Java/Jpa/"><span class="level-start"><span class="level-item">Jpa</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Java/Junit/"><span class="level-start"><span class="level-item">Junit</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Java/Jvm/"><span class="level-start"><span class="level-item">Jvm</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Javascript/"><span class="level-start"><span class="level-item">Javascript</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Nodejs/"><span class="level-start"><span class="level-item">Nodejs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/Nodejs/express/"><span class="level-start"><span class="level-item">express</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/kotlin/"><span class="level-start"><span class="level-item">kotlin</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/spring/"><span class="level-start"><span class="level-item">spring</span></span><span class="level-end"><span class="level-item tag">18</span></span></a><ul><li><a class="level is-mobile" href="/categories/spring/Batch/"><span class="level-start"><span class="level-item">Batch</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/spring/Core-Concept/"><span class="level-start"><span class="level-item">Core Concept</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/spring/Design-Pattern/"><span class="level-start"><span class="level-item">Design Pattern</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/spring/Jpa/"><span class="level-start"><span class="level-item">Jpa</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/spring/%ED%86%A0%EB%B9%84%EC%9D%98-spring/"><span class="level-start"><span class="level-item">토비의 spring</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%EA%B0%9C%EB%B0%9C-%EC%83%81%EC%8B%9D/"><span class="level-start"><span class="level-item">개발 상식</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/%EA%B0%9C%EB%B0%9C-%EC%83%81%EC%8B%9D/Git/"><span class="level-start"><span class="level-item">Git</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-02-21T14:10:36.000Z">2022-02-21</time></p><p class="title"><a href="/2022/02/21/2022-02-21-network-ch07/">통신을 도와주는 네트워크 주요 기술</a></p><p class="categories"><a href="/categories/Computer-Science/">Computer Science</a> / <a href="/categories/Computer-Science/Network/">Network</a> / <a href="/categories/Computer-Science/Network/IT-%EC%97%94%EC%A7%80%EB%8B%88%EC%96%B4%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%9E%85%EB%AC%B8/">IT 엔지니어를 위한 네트워크 입문</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-02-19T08:13:16.000Z">2022-02-19</time></p><p class="title"><a href="/2022/02/19/2022-02-19-network-ch06/">4계층 장비 (로드 밸런서 / 방화벽)</a></p><p class="categories"><a href="/categories/Computer-Science/">Computer Science</a> / <a href="/categories/Computer-Science/Network/">Network</a> / <a href="/categories/Computer-Science/Network/IT-%EC%97%94%EC%A7%80%EB%8B%88%EC%96%B4%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%9E%85%EB%AC%B8/">IT 엔지니어를 위한 네트워크 입문</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-02-17T13:27:30.000Z">2022-02-17</time></p><p class="title"><a href="/2022/02/17/2022-02-17-Item61/">Item61. 박싱된 기본 타입보다는 기본 타입을 사용하라</a></p><p class="categories"><a href="/categories/Java/">Java</a> / <a href="/categories/Java/Effective-Java-3-E/">Effective Java 3/E</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-02-17T13:26:40.000Z">2022-02-17</time></p><p class="title"><a href="/2022/02/17/2022-02-17-Item60/">Item60.정확한 답이 필요하다면float와double은 피하라</a></p><p class="categories"><a href="/categories/Java/">Java</a> / <a href="/categories/Java/Effective-Java-3-E/">Effective Java 3/E</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-02-16T13:56:41.000Z">2022-02-16</time></p><p class="title"><a href="/2022/02/16/2022-02-16-network-ch05/">3계층 장비 (라우터,L3 스위치)</a></p><p class="categories"><a href="/categories/Computer-Science/">Computer Science</a> / <a href="/categories/Computer-Science/Network/">Network</a> / <a href="/categories/Computer-Science/Network/IT-%EC%97%94%EC%A7%80%EB%8B%88%EC%96%B4%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%9E%85%EB%AC%B8/">IT 엔지니어를 위한 네트워크 입문</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">February 2022</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">42</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">November 2021</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li></ul></div></div></div><!--!--></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>